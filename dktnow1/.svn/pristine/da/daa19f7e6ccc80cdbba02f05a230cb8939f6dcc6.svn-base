<include file="Public:header"/>
<load href="__PUBLIC__/Css/Home/load.css"/>
<load href="__PUBLIC__/Css/Home/validator.css,/Public/Js/Home/FormValidator/formValidator-4.1.3.js,/Public/Js/Home/FormValidator/formValidatorRegex.js"/>
<script type="text/javascript">
<!--

//-->
</script>
<div class="wrap">
    <div class="load_area">
        <div class="load_top">
            <p>欢迎注册大课堂</p>
        </div>
        <form action="" method="post" name="rg_form" id="rg_form">
            <div class="main_left fl">
                <ul class="list_rg">
                    <li class="cf">
                        <label><i>*</i>用户名：</label>
                        <div class="w_r fl un">
                            <input type="text" name="username" value="" id="username">
                            <span class="bubble" id="usernameTip">用户名至少6位，最多十七位</span>
                        </div>
                    </li>
                    <li class="cf">
                        <label><i>*</i>密码：</label>
                        <div class="w_r fl pd">
                            <input type="password" name="pwd" value="" id="password">
                            <span class="bubble" id="passwordTip" >密码必须大于六位</span>
                        </div>
                    </li>
                    <li class="cf">
                        <label><i>*</i>确认密码：</label>
                        <div class="w_r fl cpd">
                            <input type="password" name="cfr_pwd" value="" id="repassword">
                            <span class="bubble" id="repasswordTip">请再次输入密码，两次输入必须一致</span>
                        </div>
                    </li>
                    <li class="cf">
                        <label><i>*</i>验证码：</label>
                        <div class="w_r fl yzm">
                            <input type="text" name="validate" value="" id="verify">
                            <img src="/Public/verify/" class="verifyImg" onclick="fleshVerify();">
                            <span class="bubble" id="verifyTip"><cite>看不清？</cite><a href="javascript:void(0);">换一张</a></span>
                        </div>
                    </li>
                    <li class="cf btn">
                        <label>&nbsp;</label>
                        <div class="w_r fl">
                            <a class="btn_zc"></a>
                        </div>
                    </li>
                </ul>
            </div>
        </form>
        <div class="main_right fl">
            <div class="fgr"></div>
            <div class="login_area">
                <div class="login_link">
                    <p>如已有账号，请直接登录</p>
                    <a class="llink" href="__APPURL__/Tmp/login"></a>
                </div>
            </div>
        </div>
    </div>
</div>
<script>
$(function() {
    $('input[name=username]').focus();

    $.formValidator.initConfig({formID:"rg_form",theme:"Default",submitOnce:true,
        onError:function(msg,obj,errorlist){
            $("#errorlist").empty();
            $.map(errorlist,function(msg){
                $("#errorlist").append("<li>" + msg + "</li>")
            });
        },
        ajaxPrompt : '有数据正在异步验证，请稍等...'
    });

    // 用户名
    $("#username").formValidator({onShow:"请输入用户名",onFocus:"用户名至少6个字符,最多17个字符",onCorrect:"该用户名可以注册"}).inputValidator({min:6,max:17,onError:"用户名至少6位，最多17位"}).ajaxValidator({
        dataType : "json",
        type : "get",
        cache : false,
        url : "/Public/checkName",
        success : function(data){

            return !data.status;
        },
        buttons: $("#button"),
        error: function(jqXHR, textStatus, errorThrown){showMessage("服务器没有返回数据，可能服务器忙，请重试"+errorThrown);},
        onError : "该用户名不可用，请更换用户名",
        onWait : "正在对用户名进行合法性校验，请稍候..."
    });

    // 验证码
    $("#verify").formValidator({onShow:"请输入验证码",onFocus:"请输入验证码",onCorrect:"正确"}).inputValidator({min:4,onError:"请输入验证码"});

    // 密码
    $("#password").formValidator({onShow:"请输入密码",onFocus:"密码至少6位"}).inputValidator({min:6,onError:"密码必须大于6位"}).functionValidator({
        fun:function(val,elem){
            if (/[a-zA-Z]+/.test(val) && /[0-9]+/.test(val) && /\W+\D+/.test(val)) {
                /*return '<img src="__PUBLIC__/Images/Home/enroll_better.jpg"/>';*/
                return '<span>强</span>';
            } else if(/[a-zA-Z]+/.test(val) || /[0-9]+/.test(val) || /\W+\D+/.test(val)) {
                if(/[a-zA-Z]+/.test(val) && /[0-9]+/.test(val)) {
                    /*return '<img src="__PUBLIC__/Images/Home/enroll_middle.jpg"/>';*/
                    return '<span>中</span>';
                }else if(/\[a-zA-Z]+/.test(val) && /\W+\D+/.test(val)) {
                    /*return '<img src="__PUBLIC__/Images/Home/enroll_middle.jpg"/>';*/
                    return '<span>中</span>';
                }else if(/[0-9]+/.test(val) && /\W+\D+/.test(val)) {
                    /*return '<img src="__PUBLIC__/Images/Home/enroll_middle.jpg"/>';*/
                    return '<span>中</span>';
                }else{
                    /*return '<img src="__PUBLIC__/Images/Home/enroll_weak.jpg"/>';*/
                    return '<span>弱</span>';
                }
            }
        }
    ,onDktShow:"1"});

    // 重新输入密码
    $("#repassword").formValidator({onShow:"再次输入密码",onFocus:"密码至少6位",onCorrect:"密码一致"}).inputValidator({min:6,onError:"密码必须大于6位,请确认"}).compareValidator({desID:"password",operateor:"=",onError:"俩次密码不一致,请确认"});

    // 表单提交
    $('.btn_zc').click(function() {
        $('form').attr("action","/Public/authInsert").submit();
    });

})

// 重载验证码
function fleshVerify(){
    $(".verifyImg").attr('src', '/Public/verify/'+ Math.random());
}

// 判断回车
function keydown(e){
    var e = e || event;
    if (e.keyCode==13) {
        $('.btn_zc').click();
    }
}
</script>
<include file="Public:footer"/>