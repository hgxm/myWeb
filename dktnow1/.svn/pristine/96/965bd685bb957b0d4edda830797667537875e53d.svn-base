<include file="Public:header"/>
<load href="__PUBLIC__/Css/Home/validator.css,/Public/Js/Home/FormValidator/formValidator-4.1.3.js,/Public/Js/Home/FormValidator/formValidatorRegex.js"/>
<load href="__PUBLIC__/Css/Home/info.css" />
<script>
$(function(){

    $.formValidator.initConfig({formID:"form1",theme:"Default",submitOnce:true,
        onError:function(msg,obj,errorlist){
            $("#errorlist").empty();
            $.map(errorlist,function(msg){
                $("#errorlist").append("<li>" + msg + "</li>")
            });
        },
        ajaxPrompt : '有数据正在异步验证，请稍等...'
    });

    // 初始密码
    $("#old_password").formValidator({onShow:"请输入原密码",onFocus:"请输入原密码",onCorrect:"密码正确"}).inputValidator({min:6,onError:"密码错误"}).ajaxValidator({
        dataType : "json",
        type : "get",
        cache : false,
        url : "__URL__/checkPassword",
        success : function(data){

            return !(!data.status);
        },
        buttons: $("#button"),
        error: function(jqXHR, textStatus, errorThrown){showMessage("服务器没有返回数据，可能服务器忙，请重试"+errorThrown);},
        onError : "密码错误",
        onWait : "正在对用户名进行合法性校验，请稍候..."
    });

    // 密码
    $("#a_password").formValidator({onShow:"请输入原密码",onFocus:"至少6位"}).inputValidator({min:6,onError:"密码必须大于6位"}).functionValidator({
        fun:function(val,elem){
            if (/[a-zA-Z]+/.test(val) && /[0-9]+/.test(val) && /\W+\D+/.test(val)) {
                return '<img src="__APPURL__/Images/Home/enroll_better.jpg"/>';
            } else if(/[a-zA-Z]+/.test(val) || /[0-9]+/.test(val) || /\W+\D+/.test(val)) {
                if(/[a-zA-Z]+/.test(val) && /[0-9]+/.test(val)) {
                    return '<img src="__APPURL__/Images/Home/enroll_middle.jpg"/>';
                }else if(/\[a-zA-Z]+/.test(val) && /\W+\D+/.test(val)) {
                    return '<img src="__APPURL__/Images/Home/enroll_middle.jpg"/>';
                }else if(/[0-9]+/.test(val) && /\W+\D+/.test(val)) {
                    return '<img src="__APPURL__/Images/Home/enroll_middle.jpg"/>';
                }else{
                    return '<img src="__APPURL__/Images/Home/enroll_weak.jpg"/>';
                }
            }
        }
    ,onDktShow:"1"});

    // 重新输入密码
    $("#re_password").formValidator({onShow:"再次输入密码",onFocus:"至少6位",onCorrect:"密码一致"}).inputValidator({min:6,onError:"密码必须大于6位,请确认"}).compareValidator({desID:"a_password",operateor:"=",onError:"俩次密码不一致,请确认"});

    //重置
    $('.sub_cancel').click(function(){
        var t_val = '';
        $('#a_password').next().text(t_val);
        $('#re_password').next().text(t_val);
        $('#old_password').focus();
    })
})
</script>
<div class="warp">
    <div class="body_left fl">
        <ul class="info">
            <li onclick="javascript:location.href='__URL__/index'"></li>
            <li class="info_pass"></li>
        </ul>
    </div>
    <div class="body_right fr">
        <div class="title">
            <h2><i></i>修改密码<a href="/Index" class='fr'>返回</a></h2>
        </div>
        <div class="info_center">
            <div class="userList">
                <form method="post" name="form1" id="form1" action="__URL__/update">
                    <ul class="infolist infoposs">
                        <li class="libox curr">
                            <label class="ila">当前密码：</label>
                            <input type="password" name="old_password" value="" id="old_password">
                            <span id="old_passwordTip">请输入原密码</span>
                        </li>
                        <li class="libox new">
                            <label class="ila">新密码：</label>
                            <input type="password" name="a_password" value="" id="a_password">
                            <span id="a_passwordTip">输入新密码</span>
                        </li>
                        <li class="libox new">
                            <label class="ila">再输一次：</label>
                            <input type="password" name="re_password" value="" id="re_password">
                            <span id="re_passwordTip">再次输入密码</span>
                        </li>
                        <li class="sub libox">
                            <input type="submit" name="sub_hold" value="保存信息">
                            <input type="reset" name="" value="取消" class="sub_cancel">
                        </li>
                    </ul>
                </form>
            </div>
        </div>
        <div class="clear"></div>
    </div>
    <div class="clear"></div>
</div>
<include file="Public:footer"/>