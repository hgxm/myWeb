<include file="Public:header"/>
<load href="__PUBLIC__/Css/Home/image.css"/>
<script type="text/javascript">
<!--

    $(function() {

        // 下载按钮鼠标移上样式
        $('.btn-download').mouseover(function(){
            $(this).find('.button-right').css("background","url('__APPURL__/Public/Images/Home/pic-tool.png') 0px -11px");
        }).mouseout(function(){
            $(this).find('.button-right').css("background","url('__APPURL__/Public/Images/Home/pic-tool.png') 0px 0px");
        })
        // 全屏显示鼠标移上样式
        $('.full-screen').mouseover(function(){
            $(this).find('.button-right').css("background","url('__APPURL__/Public/Images/Home/pic-tool.png') -11px -11px");
        }).mouseout(function(){
            $(this).find('.button-right').css("background","url('__APPURL__/Public/Images/Home/pic-tool.png') -11px 0px");
        })

        // 推荐标签 鼠标移过样式
        $('.tagRP li').mouseover(function(){
            if(!$(this).hasClass('hot-on')){
                $(this).addClass('hot-on').removeClass('off');
            }
        }).mouseout(function(){
            if(!$(this).hasClass('hot')) {
                $(this).removeClass('hot-on').addClass('off');
            }
        })

        //点击小图预览大图
        $(".imgList li").click(function(){
            var msrc = $(this).children('img').attr("src");
            msrc = msrc.replace('/100/', '/600/');
            $('.bigPics .picWarp li').html("<img src="+msrc+" width='600' height='450'>");
        }).eq(0).click()

        var line = 1;
        var speed = 300;
        var lineW = $('.imgList').find("li:first").width();
        var m = line;    //用于计算的变量
        var count = $('.imgList li').length;    //总共的<li>元素的个数
        var lineB = 6;    //一屏显示的个数
        var step = 13;
        var i = 1;
        var target = {$jsPath};

        // 左翻
        $('.slidePre').click(function(){
            if (!$('.smallImgs').is(":animated")) {
                if (m > line) {
                    m -= line;
                    $('.smallImgs').animate({left: "+=" + (lineW + step) + "px" }, speed);
                }else {
                    showMessage("已经是第一张了");
                }
            }
        })

        // 右翻
        $('.slideNext').click(function(){
            if (!$('.smallImgs').is(":animated")) {
                if (m < count - lineB) {
                    m += line;
                    $('.smallImgs').animate({left: "-=" + (lineW + step) +"px" }, speed);
                }else {
                    showMessage("已经是最后一张了");
                }
            }
        })

        //大图向左翻看
        $('.to-left').click(function(){
            // 小图移动
            if (m > line) {
                m -= line;
                $('.smallImgs').animate({left: "+=" + (lineW + step) +"px" }, speed);
            }

            // 大图移动
            if(i > 1) {
                if (/\/100\//.test(target[i-2])) {
                    target[i-2] = target[i-2].replace('100', '600');
                }
                $('.picWarp li img').attr("src", target[i-2]);
                i --;
                return false;
            }else {
                showMessage("已经是第一张了");
            }
        })

        //大图向右翻看
        $('.to-right').click(function(){
            // 小图移动
            if (m < count - lineB) {
                m += line;
                $('.smallImgs').animate({left: "-=" + (lineW + step) + "px" }, speed);
            }

            // 大图移动
            if(i < count) {
                if (/\/100\//.test(target[i])) {
                    target[i] = target[i].replace('100', '600');
                }
                $('.picWarp li img').attr("src", target[i]);
                i ++;
                return false;
            }else {
                showMessage("已经是最后一张了");
            }
        })

        // 收藏
        $(document).on('click', '.addfav-btn .button-label', function () {

            // 查看是否登录
            if ($('.exit').html()) {
                $.post('__APPURL__/ResourceCollect/insert/', {re_id:$('input[name=re_id]').val()}, function (json) {
                    showMessage(json.info, 1);
                }, 'json');
            } else {

                popCenterWindow();
            }
        })

        // 下载
        $(document).on('click', '.btn-download .button-label', function () {

            // 查看是否登录
            if ($('.exit').html()) {
                location.href = "__APPURL__/MyResource/download?id=" + $('input[name=re_id]').val();
            } else {

                popCenterWindow();
            }
        })

        // 资源排行
        $.getJSON('/html/today.txt', function (json) {
            if (json) {
                var htm = '';
                for (var i=0, len=json.length; i<len; i++) {
                        htm += '<li>'
                            +  '<span class="good">' + (i+1) + '</span>'
                            +  '<label title="' + json[i]['re_title'] + '"><a href="__APPURL__/Resource/index/id/' + json[i]['re_id'] + '" target="blank">' + json[i]['re_title'] + '</a></label>'
                            +  '<cite class="scro"></cite>'
                            +  '</li>'
                }
                $('.ResourceSort').append(htm);
            }
        });

    })

//-->
</script>
<div class="warp">
    <div class="pic_box fl">
        <div class="main-box">
            <!-- 左侧开始 -->
            <div class="main-left">
                <!-- 头部 -->
                <div class="pic-top-bar">
                     <ul class="breadcrumb">
                        <li>{$cate} &gt&gt {$res.re_title}</li>
                        <input type="hidden" name="re_id" value="{$res.re_id}">
                     </ul>
                     <div class="title-btns">
                        <a class="addfav-btn" href="javascript:void(0);">
                            <span class="button-label">收藏</span>
                            <span class="button-right"></span>
                        </a>
                        <a class="btn-download" href="javascript:void(0);">
                            <span class="button-label">下载</span>
                            <span class="button-right"></span>
                        </a>
                        <!-- <a class="full-screen" href="javascript:void(0);">
                            <span class="button-label">全屏</span>
                            <span class="button-right"></span>
                        </a> -->
                     </div>
                </div>
                <!-- 图片展示开始 -->
                <div class="pic_show">
                    <div class="bigPics fl">
                        <div class="to-left"><span></span></div>
                        <div class="to-right"><span></span></div>
                        <ul class="picWarp fl">
                            <li></li>
                        </ul>
                    </div>
                    <div class="smallPics fl">
                        <div class="slidePre"><span></span></div>
                        <div class="smallImgs">
                            <ul class="imgList">
                                <volist name="image" id="vo">
                                    <li><div class="bg"></div><img src="{$vo.re_savename}" alt="{$vo.re_title}" width="100" height="75" border="0"></li>
                                </volist>
                            </ul>
                        </div>
                        <div class="slideNext"><span></span></div>
                    </div>
                </div>
                <!-- 图片展示结束 -->
            </div>
            <!-- 左侧结束 -->
            <!-- 右侧开始 -->
            <div class="main-right">
                <div class="res_ranking">    <!-- 资源排行榜 -->
                    <p class="title">资源排行榜</p>
                    <ul class="ResourceSort">
                    </ul>
                </div>
            </div>
            <!-- 右侧结束 -->
        </div>
    </div>
</div>
<include file="Public:footer"/>