<include file="Public:header"/>
<load href="__PUBLIC__/Css/Ilc/user.css"/>
<script type="text/javascript">
// 表格排列
var listObj =  {"_tcheck": '8%',"_aa_id": "10%", "_aa_nickname": "15%", "_c_id": "20%", "_aa_created": "20%", '_toperate':"15%", '_pass':"8%", '_no_pass':"7%"};
$(function(){

    // 删除
    $(document).on('click','.plist ._no_pass', function() {
        var obj = $(this).parent();
        $.post('__URL__/delete', 'id='+obj.attr('attr'), function(data) {
            if (data.status > 0) {
                showMessage('操作成功', 1);
                obj.parent().remove();
            }
        }, 'json')
    })

    // 通过
    $(document).on('click','.plist ._pass', function() {
        var obj = $(this).parent();
        $.post('__URL__/pass', 'id='+obj.attr('attr'), function(data) {
            if (data > 0) {
                showMessage('操作成功', 1);
                obj.parent().remove();
            }
        }, 'json')
    })

    setWidth(listObj);
    getList();
});

// 获取教师列表
function getList(p) {

    p = p ? p :1;

    $.post('__URL__/lists', 'p='+p+'&is_ajax=1', function(json){
        var obj = json.list;
        var str = '';

        if (obj) {

            for (var i = 0; i < obj.length; i ++) {
                str += '<div class="_caption _List plist"><ul attr="'+obj[i]['aa_id']+'"><li class="_tcheck"><input type="checkbox" name="key" value="'+obj[i]['aa_id']+'"></li><li class="_aa_id">'+obj[i]['aa_id']+'</li><li class="_aa_nickname">'+obj[i]['a_nickname']+'</li><li class="_c_id">'+obj[i]['c_name']+'</li><li class="_aa_created">'+obj[i]['created']+'</li><li class="_pass">通过</li><li class="_no_pass">删除</li></ul></div>';
            }
        } else {
            str += '<div class="pli_null">暂无数据</div>';
        }

        $('#data').html('');
        $('#data').html(str);
        $('.page').html(json.page);

        setWidth(listObj);

    }, 'json');


}

</script>
<div class="warp">
    <include file="Public:left"/>
    <div class="user fl">
        <div class="user_menu">
            <volist name="secondList" id="selist">
                <a href="__APPURL__{$selist['sn_url']}" <eq name="selist.sn_name" value="TeacherStat">class="selected"</eq>>{$selist['sn_title']}</a>
            </volist>
        </div>

        <div class="filter">
            <div class="tools fl">
                <span class="pass" onclick="pass()"><i></i>通过</span>
                <span class="del"><i></i>删除</span>
            </div>
        </div>

        <div class="AuthTeacher_list fl" id="teacherStatList">
            <div class="_caption _ptitle t_caption">
                <ul>
                    <li class="_tcheck ch_nav"><input type="checkbox" onclick="CheckAll('teacherStatList')"></li>
                    <li class="_aa_id" attr="aa_id">编号</li>
                    <li class="_aa_nickname" attr="aa_nickname">申请人</li>
                    <li class="_c_id">申请班级</li>
                    <li class="_aa_created">申请时间</li>
                    <li class="_toperate">操作</li>
                </ul>
            </div>
            <div id="data"></div>
        </div>
        <div class="page"></div>
    </div>
    <div class="clear"></div>
</div>
<include file="Public:footer"/>