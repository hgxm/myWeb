//
//  AouthViewController.m
//  ClassRoomTeacher
//
//  Created by apple  on 13-7-24.
//  Copyright (c) 2013年 apple . All rights reserved.
//

#import "AouthViewController.h"

@interface AouthViewController ()

@end

@implementation AouthViewController

@synthesize autoDict;
- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
        // Custom initialization
    }
    return self;
}

- (void)viewDidLoad
{
    [super viewDidLoad];
    
    
    self.view.backgroundColor=[UIColor colorWithRed:237.0/255 green:239.0/255 blue:245.0/255 alpha:1];
    
    dele=[[UIApplication sharedApplication]delegate];
    
    backImageView=[[UIImageView alloc]initWithFrame:CGRectMake(0, 0, 1024, 748)];
    backImageView.image=[autoDict objectForKey:@"image"];
    [self.view addSubview:backImageView];
    [backImageView release];
    
    ACEDrawingView *draw=[[ACEDrawingView alloc]initWithFrame:CGRectMake(0, 0, 1024, 748)];
    [self.view addSubview:draw];
    [draw release];
    
    UIButton *btn=[UIButton buttonWithType:UIButtonTypeRoundedRect];
    btn.frame=CGRectMake(10, 20, 100, 40);
    [btn addTarget:self action:@selector(btnEnd) forControlEvents:UIControlEventTouchDown];
    [btn setTitle:@"结束学生演示" forState:UIControlStateNormal];
    [self.view addSubview:btn];
    
    

	// Do any additional setup after loading the view.
}
-(void)handelScreen:(NSString *)strBody{
    
    
    NSString *strUser=[[NSUserDefaults standardUserDefaults] objectForKey:@"textUserName"];
    NSString *strPass=[[NSUserDefaults standardUserDefaults] objectForKey:@"textPassword"];
    NSString *contentLength=[NSString stringWithFormat:@"%d",[strBody length]];
    
    
    NSMutableDictionary *mudict=[ToolClass getSocektHeadDict:strUser pass:strPass auth_type:@"2" auth_version:IOS_VERSION contentLength:contentLength contentype:@"" receiver:[autoDict objectForKey:@"a_account"]];
    
    NSString *strHead=[ToolClass getSocketHead:mudict];
    
    NSString *reqestString=[NSString stringWithFormat:@"%@%@",strHead,strBody];
    
    [[StreamSocket sharedStream] requestData:reqestString whoRequest:nil condition:0];
    
    [mudict release];
    [strHead release];
    
    
}
-(void)btnEnd{
    
    //结束学生的同步课堂
    NSString *strBody=@"{\"type\":\"12\",\"content\":\"\"}";
    
    
    NSInvocationOperation *operation = [[NSInvocationOperation alloc]initWithTarget:self selector:@selector(handelScreen:) object:strBody];
    [dele._queue addOperation:operation];
    [operation release];
    
        
    [self.navigationController popViewControllerAnimated:YES];
}
-(void)dealloc{
    
    
    [autoDict release];
    [super dealloc];
    
}
- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

@end
