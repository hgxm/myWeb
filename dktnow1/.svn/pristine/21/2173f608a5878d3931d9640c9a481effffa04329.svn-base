//
//  PanduanView.m
//  BigClassRoom
//
//  Created by apple  on 13-3-12.
//
//

#import "PanduanView.h"

@implementation PanduanView
@synthesize isShowRightAnswer;
-(id)initWithFrame:(CGRect)frame
{
    self = [super initWithFrame:frame];
    if (self) {

             isShowRightAnswer = 1;
    }
    return self;
}
-(void)changUI:(NSMutableDictionary *)dict daan:(NSMutableDictionary *)answerDict index:(int)i{
    
    muAnswerDict = answerDict;
    to_id = [[dict objectForKey:@"to_id"]intValue];
    
    [self flushSelfView:dict];

}



-(void)flushSelfView:(NSMutableDictionary *)dict{

    
      
    NSString *to_option=[dict objectForKey:@"to_option"];
    NSArray *arr=[to_option componentsSeparatedByString:@","];
    
    for (int i=0; i<[arr count]; i++) {
        
        UIImageView *imageview=[[UIImageView alloc]initWithFrame:CGRectMake(40,50*i+50, 25, 25)];
        
        if ([[arr objectAtIndex:i] intValue]==0) {
            [imageview setImage:[UIImage imageNamed:@"对.png"]];
            
        }else{
            [imageview setImage:[UIImage imageNamed:@"错.png"]];
            
        }
        [self addSubview:imageview];
        [imageview release];
        
        
        UIButton *btn=[[UIButton alloc] initWithFrame:CGRectMake(75, 50*i+50, 25, 25)];
        btn.tag=i+10;
        [btn addTarget:self action:@selector(btnActions:) forControlEvents:UIControlEventTouchDown];
        [btn setImage:[UIImage imageNamed:@"练习选择.png"] forState:UIControlStateNormal];
        
        [self addSubview:btn];
        [btn release];
        
       
    }
    
    NSString *answer = [[[dict objectForKey:@"to_answer"] JSONValue] objectAtIndex:0];
    
    
    UILabel *answerLbl = [[UILabel alloc]initWithFrame:CGRectMake(50, 50*[arr count]+50, 500, 30)];
    answerLbl.backgroundColor = [UIColor clearColor];
    answerLbl.hidden = isShowRightAnswer;
    answerLbl.text = [NSString stringWithFormat:@"正确答案:\t\t%@",[ToolClass getPanduan:answer]];
    answerLbl.font = [UIFont boldSystemFontOfSize:20];
    answerLbl.textColor = MYCOLOR;
    [self addSubview:answerLbl];
    [answerLbl release];
    
      
    int daan = [[muAnswerDict objectForKey:[NSString stringWithFormat:@"%d",to_id]] intValue];
    NSLog(@"daan is %d",daan);
    if (daan == -1) {
        
    }else{
        [self btnActions:(UIButton *)[self viewWithTag:daan +10]];
        
    }
       
}
-(void)btnActions:(UIButton *)btn{
    
    
    [btn setImage:[UIImage imageNamed:@"练习选择1.png"] forState:UIControlStateNormal];
    
    if (select!=0&&select!=btn.tag) {
        UIButton *perBtn=(UIButton *)[self viewWithTag:select];
        [perBtn setImage:[UIImage imageNamed:@"练习选择.png"] forState:UIControlStateNormal];
    }
    select=btn.tag;
    
    [muAnswerDict setObject:[NSString stringWithFormat:@"%d",btn.tag-10] forKey:[NSString stringWithFormat:@"%d",to_id]];

    NSLog(@"做了作业 is %@",muAnswerDict);
}
-(void)dealloc{
    
    [super dealloc];
}
/*
// Only override drawRect: if you perform custom drawing.
// An empty implementation adversely affects performance during animation.
- (void)drawRect:(CGRect)rect
{
    // Drawing code
}
*/

@end
